<div class="lg:col-span-5 h-2/3 lg:h-full flex flex-col min-h-0 gap-6">

   <div class="flex-[3] min-h-0">
      <div v-if="selectedCase" class="h-full flex flex-col gap-4 animate-in fade-in slide-in-from-right-4 duration-300">

         <div
            class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm shrink-0 flex justify-between items-center">
            <div class="min-w-0">
               <h3 class="font-bold text-slate-800 text-base truncate">{{ selectedCase.clientName }}</h3>
               <div class="flex gap-3 text-xs text-slate-500 mt-1">
                  <span class="bg-slate-100 px-2 py-0.5 rounded border border-slate-200 font-mono">{{
                     selectedCase.matriz }}</span>
                  <span>{{ selectedCase.route }}</span>
                  <span class="font-semibold text-brand-600">| {{ selectedCase.family }}</span>
               </div>
            </div>
            <div class="flex gap-4 text-right">
               <div>
                  <div class="text-[10px] text-slate-400 uppercase font-bold">Neto</div>
                  <div :class="selectedCase.netBalance >= 0 ? 'text-green-600' : 'text-red-600'"
                     class="text-lg font-bold">
                     {{ selectedCase.netBalance > 0 ? '+' : '' }}{{ selectedCase.netBalance.toFixed(0) }}
                  </div>
               </div>
            </div>
         </div>

         <div class="flex-1 min-h-0 relative bg-white rounded-lg border border-slate-200 p-4 shadow-sm">
            <SubstitutionChart :victim-name="selectedCase.victimSku" :victim-vector="selectedVictimVector"
               :cannibal-name="selectedCase.cannibalSku" :cannibal-vector="selectedCannibalVector"
               :split-month="store.rules.splitMonth" />
         </div>
      </div>

      <div v-else
         class="h-full bg-slate-100 rounded-lg border-2 border-dashed border-slate-300 flex flex-col items-center justify-center text-slate-400 p-8 text-center gap-4">
         <div class="bg-white p-4 rounded-full shadow-sm">
            <i class="fa-solid fa-chart-line text-2xl text-slate-300"></i>
         </div>
         <div>
            <h3 class="font-medium text-slate-600">Detalle Gráfico</h3>
            <p class="text-xs text-slate-400 mt-1">Selecciona un caso para ver la curva de sustitución.</p>
         </div>
      </div>
   </div>

   <div class="flex-[2] min-h-0">
      <AnalysisSummaryCard @export="handleExport" />
   </div>

</div>